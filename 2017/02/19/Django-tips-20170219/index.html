
 <!DOCTYPE HTML>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
  
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400">
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Inconsolata:400">
    <title>Django tips | FlamePeak</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="FlamePeak">
    

    
    <meta name="description" content="对于初学者，可以去自强学堂Django学习 那project和app什么关系呢？ 一个项目一般包含多个应用，一个应用也可以用在多个项目中。 版本的选择 Django 1.8.x 支持 Python 2.7, 3.2, 3.3, 3.4 和 3.5. （长期支持版本 LTS) Django 1.9.x 支持 Python 2.7, 3.4 和 3.5. 不支持 3.3 了 Django">
<meta name="keywords" content="Python,Django">
<meta property="og:type" content="article">
<meta property="og:title" content="Django tips">
<meta property="og:url" content="http://flamepeak.com/2017/02/19/Django-tips-20170219/index.html">
<meta property="og:site_name" content="FlamePeak">
<meta property="og:description" content="对于初学者，可以去自强学堂Django学习 那project和app什么关系呢？ 一个项目一般包含多个应用，一个应用也可以用在多个项目中。 版本的选择 Django 1.8.x 支持 Python 2.7, 3.2, 3.3, 3.4 和 3.5. （长期支持版本 LTS) Django 1.9.x 支持 Python 2.7, 3.4 和 3.5. 不支持 3.3 了 Django">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2018-01-26T08:31:39.405Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Django tips">
<meta name="twitter:description" content="对于初学者，可以去自强学堂Django学习 那project和app什么关系呢？ 一个项目一般包含多个应用，一个应用也可以用在多个项目中。 版本的选择 Django 1.8.x 支持 Python 2.7, 3.2, 3.3, 3.4 和 3.5. （长期支持版本 LTS) Django 1.9.x 支持 Python 2.7, 3.4 和 3.5. 不支持 3.3 了 Django">

    
    <link rel="alternative" href="/atom.xml" title="FlamePeak" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
  <meta name="google-site-verification" content="rYNq4pSdFJQ3Ir4VuV4A6TqVEEUP8o-rrwmST28FhQY">
  <meta name="baidu-site-verification" content="AL6EYSh1WZ">
</head>
</html>
  <body>
    <header>
      
<div>
		
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="FlamePeak">FlamePeak</a></h1>
				<h2 class="blog-motto">We know something, but we do not know more.</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/notes">Notes</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="Search" />
						<input type="hidden" name="q" value="site:flamepeak.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>

    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/02/19/Django-tips-20170219/" title="Django tips" itemprop="url">Django tips</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="FlamePeak" target="_blank" itemprop="author">FlamePeak</a>
		
  <p class="article-time">
    <time datetime="2017-02-19T07:50:13.000Z" itemprop="datePublished"> Published 2017-02-19</time>
    
  </p>
</header>
	<div class="article-content">
		
		<p>对于初学者，可以去<a href="https://code.ziqiangxuetang.com/django" target="_blank" rel="noopener">自强学堂Django</a>学习</p>
<p>那project和app什么关系呢？</p>
<p>一个项目一般包含多个应用，一个应用也可以用在多个项目中。</p>
<h3 id="版本的选择">版本的选择</h3>
<p>Django 1.8.x 支持 Python 2.7, 3.2, 3.3, 3.4 和 3.5. （长期支持版本 LTS)</p>
<p>Django 1.9.x 支持 Python 2.7, 3.4 和 3.5. 不支持 3.3 了</p>
<p>Django 1.10.x 支持 Python 2.7, 3.4 和 3.5.</p>
<p>Django 1.11.x 支持 Python 2.7, 3.4, 3.5 和 3.6（长期支持版本 LTS) 最后一个支持 Python 2.7 的版本</p>
<p>Django 2.0.x 支持 Python 3.4, 3.5 和 3.6 （注意，不再支持 Python 2）</p>
<p>这么看，对于现在来说，最好的选择是1.11.x版本，具体1.11的哪个版本，可以去<a href="https://docs.djangoproject.com/en/dev/releases/" target="_blank" rel="noopener">releases notes</a>查看</p>
<p>然后使用<code>pip install django == 1.11.10</code>来安装</p>
<h3 id="basic-command">Basic command</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">django-admin startproject mysite  <span class="comment">#创建project</span></span><br><span class="line"><span class="built_in">cd</span> mysite</span><br><span class="line">python manage.py migrate</span><br><span class="line">python manage.py runserver  <span class="comment">#goto :localhost:8000</span></span><br><span class="line">python manage.py runserver 127.0.0.1:8001 --settings=mysite.settings</span><br><span class="line">python manage.py startapp blog</span><br><span class="line"></span><br><span class="line"><span class="comment">#models</span></span><br><span class="line">python manage.py makemigrations blog</span><br><span class="line">python manage.py sqlmigrate blog 0001</span><br><span class="line">python manage.py migrate</span><br><span class="line"></span><br><span class="line"><span class="comment">#administration</span></span><br><span class="line">python manage.py createsuperuser</span><br><span class="line"><span class="comment"># Register your models here. admin.py</span></span><br><span class="line">admin.site.register(Post)</span><br><span class="line"></span><br><span class="line"><span class="comment">#open python shell</span></span><br><span class="line">python manage.py shell</span><br></pre></td></tr></table></figure>
<h3 id="projects-and-applications">Projects and Applications</h3>
<p>In Django, a project is considered a Django installation with some settings; and an application is a group of models, views, templates, and URLs. Applications interact with the framework to provide some specific functionalities and may be reused in various projects. You can think of the project as your website, which contains several applications like blog, wiki, or forum, which can be used in other projects.</p>
<h3 id="model">model</h3>
<p>A model is a Python class that subclasses <code>django.db.models.Model</code>, in which each attribute represents a database field. Django will create a table for each model defined in the <code>models.py</code> file. When you create a model, Django offers you a practical API to query the database easily.</p>
<p>Since we are going to deal with datetimes, we will install the <code>pytz</code> module. This module provides timezone definitions for Python and is required by SQLite to work with datetimes. <code>pip install pytz</code></p>
<p>Django comes with a migration system to track the changes you do to your models and propagate them into database. The <code>migrate</code> command applies migrations for all applications listed in <code>INSTALLED_APPS</code>; it synchronizes the database with the current models and migrations.</p>
<p>If you edit your <code>models.py</code> file in order to add, remove, or change fields of existing models, or if you add new models, you will have to make a new migration using the <code>makemigrations</code> command. The migration will allow Django to keep track of model changes. Then you will have to apply it with the <code>migrate</code> command to keep the database in sync with your models.</p>
<h3 id="views">views</h3>
<p>Creating an <code>urls.py</code> file for each app is the best way to make your applications reusable by other projects.</p>
<h3 id="urls.py-name详解">urls.py name详解</h3>
<p><a href="https://code.ziqiangxuetang.com/django/django-url-name.html" target="_blank" rel="noopener">urls.py name详解</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">from django.conf.urls import url</span><br><span class="line">from django.contrib import admin</span><br><span class="line">from calc import views as calc_views</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">urlpatterns = [</span><br><span class="line">    url(r&apos;^add/$&apos;, calc_views.add, name=&apos;add&apos;),</span><br><span class="line">    url(r&apos;^add/(\d+)/(\d+)/$&apos;, calc_views.add2, name=&apos;add2&apos;),</span><br><span class="line">    url(r&apos;^admin/&apos;, admin.site.urls),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p><code>url(r'^add/$', calc_views.add, name='add')</code>, 这里的 name='add' 是用来干什么的呢？</p>
<p>简单说，name 可以用于在 templates, models, views ……中得到对应的网址，相当于“给网址取了个名字”，只要这个名字不变，网址变了也能通过名字获取到。</p>
<p>如果网页里面写成死网址，例如<code>&lt;a href="/add/4/5/"&gt;计算 4+5&lt;/a&gt;</code>，会造成后期修改代价很大，容易造成死链接。</p>
<p>首先介绍一下如何在Django中用Python获取对应的网址(可以用在views.py、models.py等需要转换得到网址的地方)，</p>
<p>进入shell, <code>python manage.py shell</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; from django.core.urlresolvers import reverse  # django 1.4.x - django 1.10.x</span><br><span class="line">或者</span><br><span class="line">&gt;&gt;&gt; from django.urls import reverse  # Django 1.10.x - Django 2.x 新的，更加规范了</span><br><span class="line"> </span><br><span class="line">&gt;&gt;&gt; reverse(&apos;add2&apos;, args=(4,5))</span><br><span class="line">u&apos;/add/4/5/&apos;</span><br><span class="line">&gt;&gt;&gt; reverse(&apos;add2&apos;, args=(444,555))</span><br><span class="line">u&apos;/add/444/555/&apos;</span><br></pre></td></tr></table></figure>
<p><strong>reverse 接收url中的name作为第一个参数</strong>，这样，我们就可以通过<code>reverse()</code>来获取对应的网址，只要是url中的name不改，就不需要更改代码中的网址。</p>
<p>在网页模板中也是如此，可以很方便的使用：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">不带参数的：</span><br><span class="line">&#123;% url &apos;name&apos;%&#125;</span><br><span class="line"></span><br><span class="line">带参数的：参数可以是变量名</span><br><span class="line">&#123;% url &apos;name&apos; 参数 %&#125;</span><br></pre></td></tr></table></figure>
<p>例如：<br>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;a href=&quot;&#123;% url &apos;add2&apos; 4 5 %&#125;&quot;&gt;link&lt;/a&gt;</span><br></pre></td></tr></table></figure></p>
<p>将被渲染为 <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;a href=&quot;/add/4/5/&quot;&gt;link&lt;/a&gt;</span><br><span class="line">```  </span><br><span class="line">当urls.py更改时，前提是不更改name(这个参数设定好后不要轻易更改), 获取网址也会动态变化，比如更改为:</span><br></pre></td></tr></table></figure></p>
<p>url(r'^new_add/()/()/$', calc_views.add2, name='add2'), <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">网址将会被渲染为：</span><br></pre></td></tr></table></figure></p>
<p><a href="/new_add/4/5/">link</a> <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">用在views.py和models.py等地方的reverse()函数，同样会根据name对应url获取到新网址。</span><br><span class="line"></span><br><span class="line">想要改网址的时候，只需修改urls.py中的正则表达式，其它部分都不需要修改。</span><br><span class="line"></span><br><span class="line">**另外，比如用户的收藏夹中的URL是旧的，如何让以前的/add/3/4自动跳转到新的网址呢？**</span><br><span class="line"></span><br><span class="line">Django没有替你完成这个工作，需要自己来写一个跳转方法。</span><br><span class="line"></span><br><span class="line">具体的，在views.py写一个跳转函数：</span><br></pre></td></tr></table></figure></p>
<p>from django.http import HttpResponseRedirect from django.urls import reverse</p>
<p>def old_add2_redirect(request, a, b): return HttpResponseRedirect( reverse('add2', args=(a, b)) ) <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">在urls.py中：</span><br></pre></td></tr></table></figure></p>
<p>url(r'^add/()/()/<span class="math inline">\(&#39;, calc_views.old_add2_redirect), url(r&#39;new_add/(\d+)/(\d+)/\)</span>', calc_views.add2, name='add2'), <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">开始可能觉得直接写网址简单，但是用多了你一定会发现，用“死网址”的方法很糟糕。</span><br><span class="line"></span><br><span class="line">### Django 网页模板 继承</span><br><span class="line"></span><br><span class="line">[Django template](https://code.ziqiangxuetang.com/django/django-template.html)</span><br><span class="line"></span><br><span class="line">[Django template 进阶](https://code.ziqiangxuetang.com/django/django-template2.html)</span><br><span class="line"></span><br><span class="line">一般的变量之类的用 `&#123;&#123; &#125;&#125;`（变量），功能类的，比如循环，条件判断是用 `&#123;%  %&#125;`（标签）</span><br><span class="line"></span><br><span class="line">例如：  </span><br><span class="line">views.py</span><br></pre></td></tr></table></figure></p>
<p>def home(request): TutorialList = ["HTML", "CSS", "jQuery", "Python", "Django"] return render(request, 'home.html', {'TutorialList': TutorialList}) <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">home.html</span><br></pre></td></tr></table></figure></p>

<p>```</p>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Python/">Python</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Python/">Python</a><a href="/tags/Django/">Django</a>
  </div>

</div>


	<div class="article-share" id="share">
	
	  <div data-url="http://flamepeak.com/2017/02/19/Django-tips-20170219/" data-title="Django tips | FlamePeak" data-tsina="null" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2017/02/23/Windows-tips-20170223/" title="Windows 使用与问题解决">
  <strong>上一篇：</strong><br/>
  <span>
  Windows 使用与问题解决</span>
</a>
</div>


<div class="next">
<a href="/2017/02/16/Python-str-tips-20170216/"  title="Python数据处理的一些技巧">
 <strong>下一篇：</strong><br/> 
 <span>Python数据处理的一些技巧
</span>
</a>
</div>

</nav>

	

</div>  

      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">Contents</strong>
 
 <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#版本的选择"><span class="toc-number">1.</span> <span class="toc-text">版本的选择</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#basic-command"><span class="toc-number">2.</span> <span class="toc-text">Basic command</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#projects-and-applications"><span class="toc-number">3.</span> <span class="toc-text">Projects and Applications</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#model"><span class="toc-number">4.</span> <span class="toc-text">model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#views"><span class="toc-number">5.</span> <span class="toc-text">views</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#urls.py-name详解"><span class="toc-number">6.</span> <span class="toc-text">urls.py name详解</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">

  


  
<div class="categorieslist">
	<p class="asidetitle">Categories</p>
		<ul>
		
		  
			<li><a href="/categories/Android/" title="Android">Android<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/Cryptography/" title="Cryptography">Cryptography<sup>16</sup></a></li>
		  
		
		  
			<li><a href="/categories/Hardware/" title="Hardware">Hardware<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Life/" title="Life">Life<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/Linux/" title="Linux">Linux<sup>45</sup></a></li>
		  
		
		  
			<li><a href="/categories/Network-Security/" title="Network Security">Network Security<sup>19</sup></a></li>
		  
		
		  
			<li><a href="/categories/Python/" title="Python">Python<sup>42</sup></a></li>
		  
		
		  
			<li><a href="/categories/Tools/" title="Tools">Tools<sup>22</sup></a></li>
		  
		
		  
			<li><a href="/categories/Web前端/" title="Web前端">Web前端<sup>20</sup></a></li>
		  
		
		  
			<li><a href="/categories/Web后端/" title="Web后端">Web后端<sup>14</sup></a></li>
		  
		
		  
			<li><a href="/categories/人工智能/" title="人工智能">人工智能<sup>7</sup></a></li>
		  
		
		  
			<li><a href="/categories/百家杂谈/" title="百家杂谈">百家杂谈<sup>21</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">Tags</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/Python/" title="Python">Python<sup>43</sup></a></li>
			
		
			
				<li><a href="/tags/Linux/" title="Linux">Linux<sup>35</sup></a></li>
			
		
			
				<li><a href="/tags/C/" title="C">C<sup>21</sup></a></li>
			
		
			
				<li><a href="/tags/笔记/" title="笔记">笔记<sup>18</sup></a></li>
			
		
			
				<li><a href="/tags/cryptography/" title="cryptography">cryptography<sup>11</sup></a></li>
			
		
			
				<li><a href="/tags/Hexo/" title="Hexo">Hexo<sup>10</sup></a></li>
			
		
			
				<li><a href="/tags/JavaScript/" title="JavaScript">JavaScript<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/Life/" title="Life">Life<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/MongoDB/" title="MongoDB">MongoDB<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/Network-Security/" title="Network Security">Network Security<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/Mysql/" title="Mysql">Mysql<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/Docker/" title="Docker">Docker<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/Tools/" title="Tools">Tools<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/Chrome/" title="Chrome">Chrome<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/Scrapy/" title="Scrapy">Scrapy<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/Kali/" title="Kali">Kali<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/VPN/" title="VPN">VPN<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/Learning/" title="Learning">Learning<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/Windows/" title="Windows">Windows<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/Tips/" title="Tips">Tips<sup>3</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">Links</p>
    <ul>
        
          <li>
            
            	<a href="http://blog.yoqi.me/lyq/16489.html" target="_blank" title="Github Hosts">Github Hosts</a>
            
          </li>
        
          <li>
            
            	<a href="http://overapi.com" target="_blank" title="OverAPI">OverAPI</a>
            
          </li>
        
          <li>
            
            	<a href="https://devdocs.io" target="_blank" title="DevDocs">DevDocs</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS</a>
</div>

</aside>
</div>

    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> 善良   善学   勇敢   坚毅 <br/>
			努力   克制   谦虚   执着</p>
	</section>
	 
	<div id="social-font" class="clearfix">
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">Hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2021 
		
		<a href="/about" target="_blank" title="FlamePeak">FlamePeak</a>
		
		





		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
        getSize();
        if (myWidth >= 1024) {
          $('#toc.toc-aside').css('display', 'block');
          c.click();
        }
  
  $(window).resize(function(){
    getSize();
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
      
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});
</script>











<!-- Analytics Begin -->
<!--%- partial('analytics') %-->
<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="Back to Top"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>

